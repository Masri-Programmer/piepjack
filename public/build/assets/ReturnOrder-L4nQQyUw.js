import{p as j,q as x,s as K,r as p,v as y,x as F,a as q,c as W,o as X,d as u,e as l,f as e,h,k as b,g as R,u as a,$ as Y,t as s,z as Z,A as c,B as $,l as B,C as ee,F as A,i as L,G as re,D as U,a0 as N,a1 as te}from"./app-z53oRgF3.js";const oe={class:"return-order-container"},se={class:"return-order-title"},ne=["placeholder"],ae=["placeholder"],le=["disabled"],ue={key:1},ie={key:1,class:"return-order-products"},de={class:"return-order-grid"},ce=["onClick"],me=["placeholder"],pe={key:2,class:"return-order-shipping"},ve={class:"return-order-total"},he={class:"return-order-description"},be={class:"return-order-shipping-option"},fe={class:"return-order-radio"},_e={class:"return-order-insurance"},ke={class:"return-order-subtitle"},ge={class:"return-order-insurance-option"},ye={class:"return-order-radio"},$e={class:"return-order-info"},Ne={class:"return-order-insurance-option"},Se={class:"return-order-radio"},we={class:"return-order-info"},Ce={class:"return-order-summary"},Oe={class:"return-order-total-price"},Ve={class:"return-order-terms"},Fe={class:"return-order-checkbox"},qe=["disabled"],D=4.9,Re=1.99,Be=20,De={__name:"ReturnOrder",setup(Ae){const{t:m}=j(),M=x(),S=K(),T=S.params.slug,i=p(1),d=p([]),n=y("active-return-form",{email:F.value.email||y("active-return-form").value?.email||"",orderNr:"",orderId:null,reason:""}),w=p({}),{data:f,isLoading:_,refetch:I}=q("orders").useGetById(S.params.slug??n.value.orderNr),P=async()=>{try{const{data:r}=await I();if(!r||!r.data.products)throw new Error(m("common.alerts.orderNotFound"));i.value=2}catch(r){alert(r.message||m("common.alerts.fetchError")),console.error("Failed to fetch order:",r)}},z=async()=>{if(!n.value.email||!n.value.orderNr){alert(m("common.alerts.fillAllFields"));return}await P()},E=r=>{const t=d.value.findIndex(o=>o.id===r.id);t===-1?d.value.push(r):d.value.splice(t,1)},C=r=>d.value.some(t=>t.id===r.id),k=()=>{i.value=Math.max(i.value-1,1)},G=()=>{if(d.value.length===0){alert(m("common.alerts.selectAtLeastOneProduct"));return}if(!n.value.reason.trim()){alert(m("common.alerts.provideReason"));return}i.value=3},O=p("DHL Parcel Shop"),g=p(!1),v=p(!1),V=W(()=>v.value?D+Re:D),{mutate:H}=q("returns").useStore(w),J=()=>{const r={total:V.value,order_number:n.value.orderNr,order_id:f.value.data.id,email:n.value.email,status:"requested",reason:n.value.reason,items:JSON.parse(JSON.stringify(d.value))};H(r,{onSuccess:t=>{t?.checkout_url&&(window.location.href=t.checkout_url)}})},Q=()=>{d.value=[],n.value={email:F.value.email||y("active-return-form").value?.email||"",orderNr:"",reason:""},i.value=1,w.value={}};return X(()=>{T==="success"&&(Q(),M.success(m("common.alerts.returnSuccess")))}),(r,t)=>(l(),u("div",oe,[e("h1",se,[i.value>1?(l(),u("button",{key:0,onClick:t[0]||(t[0]=o=>k()),"aria-label":"Go Back",class:"return-order-back-button"},[R(a(Y),{size:"30"})])):h("",!0),b(" "+s(r.$t("common.titles.return_exchange")),1)]),i.value===1?(l(),u("form",{key:0,onSubmit:Z(z,["prevent"]),class:"return-order-form","aria-label":"Return Order Form"},[c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a(n).email=o),class:"return-order-input",id:"email",type:"email",placeholder:r.$t("common.input.email"),required:"","aria-label":"Email Address"},null,8,ne),[[$,a(n).email]]),c(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>a(n).orderNr=o),class:"return-order-input",id:"orderNr",type:"text",placeholder:r.$t("common.input.orderTracking"),required:"","aria-label":"Order Number"},null,8,ae),[[$,a(n).orderNr]]),e("button",{type:"submit",disabled:a(_),class:"return-order-button-submit view-all"},[a(_)?(l(),B(ee,{key:0,center:"",size:"xs"})):(l(),u("span",ue,s(r.$t("components.buttons.returnOrder")),1))],8,le)],32)):h("",!0),i.value===2&&!a(_)&&a(f)?.data.products?(l(),u("div",ie,[e("div",de,[(l(!0),u(A,null,L(a(f)?.data.products,o=>(l(),u("div",{key:o.item,class:re(["return-order-product-card",{"is-selected":C(o.item)}]),onClick:Le=>E(o.item)},[R(U,{product:o,item:o.item,label:"no-label"},null,8,["product","item"])],10,ce))),128))]),e("p",null,s(r.$t("common.return.provide_reason")),1),c(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>a(n).reason=o),class:"return-order-reason-textarea",placeholder:r.$t("common.return.reason_placeholder"),required:"","aria-label":"Reason for Return"},null,8,me),[[$,a(n).reason]]),e("button",{onClick:k,class:"return-order-button-back view-all"},s(r.$t("common.return.back")),1),e("button",{onClick:G,class:"return-order-button-next view-all"},s(r.$t("common.return.next")),1)])):h("",!0),i.value===3?(l(),u("div",pe,[e("p",null,s(r.$t("common.return.reason",{reason:a(n).reason})),1),(l(!0),u(A,null,L(a(f)?.data.products,o=>(l(),u("div",{key:o.item,class:"return-order-selected-product"},[C(o.item)?(l(),B(U,{key:0,product:o,item:o.item,label:"no-label"},null,8,["product","item"])):h("",!0)]))),128)),e("h1",ve,s(r.$t("common.return.select_shipping")),1),e("p",he,s(r.$t("common.return.select_shipping_desc")),1),e("div",be,[e("label",fe,[c(e("input",{type:"radio",value:"DHL Parcel Shop","onUpdate:modelValue":t[4]||(t[4]=o=>O.value=o),required:""},null,512),[[N,O.value]]),b(" "+s(r.$t("common.return.dhl"))+" ",1),t[8]||(t[8]=e("span",{class:"return-order-price"},"4,90 €",-1))])]),e("div",_e,[e("h2",ke,s(r.$t("common.return.insurance")),1),e("div",ge,[e("label",ye,[c(e("input",{type:"radio",value:!0,"onUpdate:modelValue":t[5]||(t[5]=o=>v.value=o),"true-value":!0,"false-value":!1,required:""},null,512),[[N,v.value]]),b(" "+s(r.$t("common.return.insurance_yes"))+" ",1),t[9]||(t[9]=e("span",{class:"return-order-price"},"1,99 €",-1))]),e("p",$e,s(r.$t("common.return.insurance_info",{amount:Be})),1)]),e("div",Ne,[e("label",Se,[c(e("input",{type:"radio",value:!1,"onUpdate:modelValue":t[6]||(t[6]=o=>v.value=o),"true-value":!0,"false-value":!1,required:""},null,512),[[N,v.value]]),b(" "+s(r.$t("common.return.insurance_no")),1)]),e("p",we,s(r.$t("common.return.insurance_warning")),1)])]),e("div",Ce,[e("p",Oe,[e("strong",null,s(r.$t("common.return.total_amount",{total:V.value.toFixed(2)})),1)])]),e("div",Ve,[e("label",Fe,[c(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=o=>g.value=o),required:"","aria-label":"Accept Terms and Conditions"},null,512),[[te,g.value]]),b(" "+s(r.$t("common.return.terms")),1)])]),e("button",{onClick:k,class:"return-order-button-back"},s(r.$t("common.return.back_products")),1),e("button",{disabled:!g.value,onClick:J,class:"return-order-button-final view-all"},s(r.$t("common.return.next_step")),9,qe)])):h("",!0)]))}};export{De as default};
